mode: ContinuousDelivery
commit-message-incrementing: MergeMessageOnly

major-version-bump-message: '\+semver:\s?(breaking|major)'
minor-version-bump-message: '\+semver:\s?(feature|minor)'
patch-version-bump-message: '\+semver:\s?(fix|patch)'
no-bump-message: '\+semver:\s?(none|skip)'
tag-prefix: '[vV]?'
semantic-version-format: Strict

prevent-increment:
  when-current-commit-tagged: true

branches:
  main:
    mode: ContinuousDeployment
    regex:  ^master$|^main$
    label: ''          # 1.1.0 (sin sufijo)
    increment: Patch
    is-main-branch: true
    prevent-increment:
      of-merged-branch: true
    track-merge-message: true
    is-source-branch-for:
    - release
    - QA
    - develop
    - hotfix
    - sprint

  sprint:
    mode: ContinuousDelivery
    regex: ^sprint\/(?<BranchName>.+)$
    label: pre         # 1.1.0-pre.N
    increment: Minor
    prevent-increment:
      of-merged-branch: true
    track-merge-message: true
    source-branches:
    - develop
    - QA
    - main
    - release
    
  develop:
    mode: ContinuousDelivery
    regex: ^develop$
    label: dev         # 1.1.0-dev.N
    increment: Inherit
    prevent-increment:
      of-merged-branch: true
    track-merge-message: true
    tracks-release-branches: false
    source-branches:
    - QA
    - main
    - release
    is-source-branch-for:
    - sprint

  QA:
    mode: ContinuousDelivery
    regex: ^QA$    # acepta QA/qa
    label: qa          # 1.1.0-qa.N
    increment: Inherit
    prevent-increment:
      of-merged-branch: true
    track-merge-message: true
    tracks-release-branches: false
    source-branches:
    - QA
    - main
    - develop
    is-source-branch-for:
    - develop

  release:
    mode: ContinuousDelivery
    regex: ^releases?[\/-].+
    label: rc          # 1.1.0-rc.N
    increment: Inherit
    track-merge-message: true
    tracks-release-branches: false
    source-branches:
    - QA
    - main
    - develop

  hotfix:
    mode: ContinuousDelivery
    # Si usas hotfix/* y quieres pre-release identificable
    regex: ^hotfix(es)?[\/-].+
    label: fix         # 1.1.0-hotfix.N
    increment: Patch
    prevent-increment:
      of-merged-branch: true
    source-branches:
    - main

  pull-request:
    mode: ContinuousDelivery
    regex: ^(pull-requests|pull|pr|PR9|merge)[\/-].*
    label: PullRequest
    increment: Inherit
    track-merge-message: true
    label-number-pattern: ''
    source-branches:
    - main
    - release
    - QA
    - develop
    - hotfix
    - sprint
